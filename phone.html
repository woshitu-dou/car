<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>车机娱乐系统 - 手机控制端</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-dark text-light min-h-screen overflow-x-hidden">
  <!-- 背景装饰 -->
  <div class="fixed inset-0 bg-gradient-to-br from-dark via-dark/95 to-primary/20 bg-animate -z-10"></div>
  <div class="fixed inset-0 bg-[url('https://picsum.photos/id/1025/1920/1080')] bg-cover bg-center opacity-10 -z-10"></div>
  
  <!-- 手机控制端界面 -->
  <div id="phone-interface" class="min-h-screen">
    <!-- 顶部导航 -->
    <header class="glass-effect sticky top-0 z-50 px-6 py-4">
      <div class="flex justify-between items-center">
        <button class="hover:text-primary transition-colors" onclick="window.location.href='index.html'">
          <i class="fa fa-arrow-left"></i>
        </button>
        <h1 class="text-xl font-bold">手机控制端</h1>
        <div class="w-6"></div> <!-- 占位元素，保持标题居中 -->
      </div>
    </header>
    
    <!-- 连接状态 -->
    <div class="bg-primary/20 border border-primary/30 rounded-lg m-6 p-4 flex items-center">
      <div id="connection-pulse" class="w-3 h-3 rounded-full bg-gray-500 mr-3"></div>
      <p class="text-sm" id="connection-status-text">正在连接到车机娱乐屏...</p>
    </div>
    
    <!-- 控制区域 -->
    <main class="container mx-auto px-6 py-4">
      <h2 class="text-lg font-semibold mb-4">远程控制</h2>
      
      <!-- 快速切换应用 - 视频应用 -->
      <div class="glass-effect rounded-xl p-5 mb-6">
        <h3 class="text-base font-medium mb-4">视频应用</h3>
        
        <div class="grid grid-cols-2 gap-3">
          <button class="flex flex-col items-center p-3 rounded-lg hover:bg-white/10 transition-colors" onclick="controlApp('iqiyi')">
            <div class="w-16 h-16 bg-iqiyi/20 rounded-lg flex items-center justify-center mb-2">
              <i class="fa fa-play-circle text-2xl text-iqiyi"></i>
            </div>
            <span>爱奇艺PAD</span>
          </button>
          
          <button class="flex flex-col items-center p-3 rounded-lg hover:bg-white/10 transition-colors" onclick="controlApp('bilibili')">
            <div class="w-16 h-16 bg-bilibili/20 rounded-lg flex items-center justify-center mb-2">
              <i class="fa fa-play-circle text-2xl text-bilibili"></i>
            </div>
            <span>哔哩哔哩HD</span>
          </button>
          
          <button class="flex flex-col items-center p-3 rounded-lg hover:bg-white/10 transition-colors" onclick="controlApp('tencent')">
            <div class="w-16 h-16 bg-tencent/20 rounded-lg flex items-center justify-center mb-2">
              <i class="fa fa-play-circle text-2xl text-tencent"></i>
            </div>
            <span>腾讯视频HD</span>
          </button>
          
          <button class="flex flex-col items-center p-3 rounded-lg hover:bg-white/10 transition-colors" onclick="controlApp('youku')">
            <div class="w-16 h-16 bg-youku/20 rounded-lg flex items-center justify-center mb-2">
              <i class="fa fa-play-circle text-2xl text-youku"></i>
            </div>
            <span>优酷HD</span>
          </button>
        </div>
      </div>
      
      <!-- 快速切换应用 - 常用应用 -->
      <div class="glass-effect rounded-xl p-5 mb-6">
        <h3 class="text-base font-medium mb-4">常用应用</h3>
        
        <div class="grid grid-cols-2 gap-3">
          <button class="flex flex-col items-center p-3 rounded-lg hover:bg-white/10 transition-colors" onclick="controlApp('wechat')">
            <div class="w-16 h-16 bg-wechat/20 rounded-lg flex items-center justify-center mb-2">
              <i class="fa fa-weixin text-2xl text-wechat"></i>
            </div>
            <span>微信</span>
          </button>
          
          <button class="flex flex-col items-center p-3 rounded-lg hover:bg-white/10 transition-colors" onclick="controlApp('qq')">
            <div class="w-16 h-16 bg-qq/20 rounded-lg flex items-center justify-center mb-2">
              <i class="fa fa-qq text-2xl text-qq"></i>
            </div>
            <span>QQ</span>
          </button>
          
          <button class="flex flex-col items-center p-3 rounded-lg hover:bg-white/10 transition-colors" onclick="controlApp('browser')">
            <div class="w-16 h-16 bg-primary/20 rounded-lg flex items-center justify-center mb-2">
              <i class="fa fa-chrome text-2xl text-primary"></i>
            </div>
            <span>浏览器</span>
          </button>
          
          <button class="flex flex-col items-center p-3 rounded-lg hover:bg-white/10 transition-colors" onclick="controlApp('music')">
            <div class="w-16 h-16 bg-purple-500/20 rounded-lg flex items-center justify-center mb-2">
              <i class="fa fa-music text-2xl text-purple-500"></i>
            </div>
            <span>音乐</span>
          </button>
        </div>
      </div>
      
      <!-- 控制指令 -->
      <div class="glass-effect rounded-xl p-5 mb-6">
        <h3 class="text-base font-medium mb-4">控制指令</h3>
        
        <div class="grid grid-cols-2 gap-3">
          <button class="flex items-center justify-center p-3 rounded-lg border border-gray-700 hover:border-primary hover:text-primary transition-colors">
            <i class="fa fa-step-backward mr-2"></i> 返回
          </button>
          
          <button class="flex items-center justify-center p-3 rounded-lg border border-gray-700 hover:border-primary hover:text-primary transition-colors">
            <i class="fa fa-home mr-2"></i> 主页
          </button>
          
          <button class="flex items-center justify-center p-3 rounded-lg border border-gray-700 hover:border-primary hover:text-primary transition-colors">
            <i class="fa fa-volume-up mr-2"></i> 音量+
          </button>
          
          <button class="flex items-center justify-center p-3 rounded-lg border border-gray-700 hover:border-primary hover:text-primary transition-colors">
            <i class="fa fa-volume-down mr-2"></i> 音量-
          </button>
        </div>
      </div>
      
      <!-- 最近活动 -->
      <div class="glass-effect rounded-xl p-5">
        <h3 class="text-base font-medium mb-4">最近活动</h3>
        
        <div class="space-y-3">
          <div class="flex items-center p-2 border-b border-gray-800">
            <div class="w-8 h-8 bg-bilibili/20 rounded-full flex items-center justify-center mr-3">
              <i class="fa fa-play-circle text-bilibili text-sm"></i>
            </div>
            <div class="flex-1">
              <p class="text-sm">启动了哔哩哔哩HD</p>
              <p class="text-xs text-gray-400">5分钟前</p>
            </div>
          </div>
          
          <div class="flex items-center p-2 border-b border-gray-800">
            <div class="w-8 h-8 bg-primary/20 rounded-full flex items-center justify-center mr-3">
              <i class="fa fa-volume-up text-primary text-sm"></i>
            </div>
            <div class="flex-1">
              <p class="text-sm">调整了音量</p>
              <p class="text-xs text-gray-400">12分钟前</p>
            </div>
          </div>
          
          <div class="flex items-center p-2">
            <div class="w-8 h-8 bg-tencent/20 rounded-full flex items-center justify-center mr-3">
              <i class="fa fa-play-circle text-tencent text-sm"></i>
            </div>
            <div class="flex-1">
              <p class="text-sm">启动了腾讯视频HD</p>
              <p class="text-xs text-gray-400">30分钟前</p>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <!-- 提示信息容器 -->
  <div id="toast"></div>

  <script src="script.js"></script>
  <script>
    // 初始化设备连接器
    const connector = new DeviceConnector();
    connector.setDeviceType('phone');
    
    // 更新连接状态显示
    function updateConnectionStatus() {
      const pulseElement = document.getElementById('connection-pulse');
      const statusElement = document.getElementById('connection-status-text');
      
      if (connector.getConnectionStatus()) {
        statusElement.textContent = '已连接到车机娱乐屏';
        pulseElement.className = 'w-3 h-3 rounded-full bg-green-500 mr-3 pulse';
      } else {
        // 尝试连接
        if (connector.connect()) {
          updateConnectionStatus();
        } else {
          statusElement.textContent = '未连接到车机，请确保在同一网络';
          pulseElement.className = 'w-3 h-3 rounded-full bg-red-500 mr-3';
        }
      }
    }
    
    // 定期检查连接状态
    setInterval(updateConnectionStatus, 2000);
    updateConnectionStatus();
    
    // 控制车机应用
    function controlApp(appId) {
      const app = apps[appId];
      if (!app) return;
      
      if (!connector.getConnectionStatus()) {
        showToast('未连接到车机，请检查连接');
        return;
      }
      
      // 发送启动应用命令
      const success = connector.sendCommand({
        type: 'launchApp',
        data: { appId: appId }
      });
      
      if (success) {
        showToast(`已控制车机启动 ${app.name}`);
        
        // 记录最近活动（简单模拟）
        recordActivity(appId);
      } else {
        showToast('控制失败，请重试');
      }
    }
    
    // 记录活动（简单模拟）
    function recordActivity(appId) {
      const app = apps[appId];
      if (!app) return;
      
      // 在实际应用中，这里会更新服务器或本地存储的活动记录
      console.log(`记录活动: 启动了 ${app.name}`);
    }
  </script>
</body>
</html>
